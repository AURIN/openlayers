<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Seamless tiled GeoJSON and TopoJSON</title>
<link rel="stylesheet" href="../theme/default/style.css" type="text/css">
<link rel="stylesheet" href="style.css" type="text/css">
<style type="text/css">
#controlToggle li {
	list-style: none;
}
</style>
<script src="../lib/OpenLayers.js"></script>
<script type="text/javascript">
  var mapTile, mapTopo, drawControls;
  var epsg4326 = new OpenLayers.Projection('EPSG:4326');
  var epsg900913 = new OpenLayers.Projection('EPSG:900913');
  
  function init() {
    mapTile = new OpenLayers.Map('mapTile', {
      displayProjection : epsg900913
    });
    mapTopo = new OpenLayers.Map('mapTopo', {
      displayProjection : epsg900913
    });

    // OpenStreetMap base layer with numZoomLevels set to number of data levels provided with this example
    var baseLayer = new OpenLayers.Layer.OSM("OpenStreetmap", [
        'http://a.tile.stamen.com/toner/${z}/${x}/${y}.png',
        'http://b.tile.stamen.com/toner/${z}/${x}/${y}.png',
        'http://c.tile.stamen.com/toner/${z}/${x}/${y}.png' ], {
      minZoomLevel : 4,
      maxZoomLevel : 17,
      projection : epsg900913
    });
    mapTile.addLayer(baseLayer);
    mapTopo.addLayer(baseLayer.clone());

    // GeoJson polygon tiled layer (LGAs drawn in pink)
    var tileLayer = new OpenLayers.Layer.SeamlessGeoJSON("Json LGA",
        "http://localhost/vts/layers/lga/${z}/${x}/${y}.json", {
          projection : epsg900913,
          initialdelay: 500,
          tileloaddelay: 400,
          minZoomLevel : 0,
          maxZoomLevel : 20,
          styleMap: new OpenLayers.StyleMap({default:  new OpenLayers.Style({
            strokeColor : "#FF66CC",
            fill : true,
            fillOpacity : 0.2,
            fillColor : "#FF66CC"
          }),
            select:  new OpenLayers.Style({
              strokeColor : "#66FFFF",
              fill : true,
              fillOpacity : 0.2,
              fillColor : "#66FFFF"
            })
          })
        }); 
     
    // TopoJson polygon tiled layer (PBCs drawn in orange)
    var topoLayer = new OpenLayers.Layer.SeamlessGeoJSON("Topo PBC",
        "http://localhost/vts/layers/pbc/${z}/${x}/${y}.topojson", {
          projection : epsg900913,
          format : "topojson",
          initialdelay: 500,
          tileloaddelay: 400,
          minZoomLevel : 0,
          maxZoomLevel : 20,
          styleMap: new OpenLayers.StyleMap({default:  new OpenLayers.Style({
            strokeColor : "#FF9933",
            fill : true,
            fillOpacity : 0.2,
            fillColor : "#FF9933"
          }),
            select:  new OpenLayers.Style({
              strokeColor : "#66FFFF",
              fill : true,
              fillOpacity : 0.2,
              fillColor : "#66FFFF"
            })
          })
        });

    // GeoJSON line tiled layer (drawn in green), visible only for Victoria at high zoom levels
    /*
    var streetLayer = new OpenLayers.Layer.SeamlessGeoJSON("Streets",
        "http://localhost/vts/layers/street/${z}/${x}/${y}.json", {
          projection : epsg900913,
          format : "json",
          initialdelay: 500,
          tileloaddelay: 400,
          minZoomLevel : 15,
          maxZoomLevel : 20,
          styleMap: new OpenLayers.StyleMap({default:  new OpenLayers.Style({
              strokeColor : "#99FF99",
              strokeWidth : 4,
              fill: false
          }),
            select:  new OpenLayers.Style({
              strokeColor : "#66FFFF",
              fill: false
            })
          })
        });
    */
//    mapTile.addLayer(streetLayer);
    mapTile.addLayer(tileLayer);
    mapTile.addControl(new OpenLayers.Control.Navigation({
      dragPanOptions : {
        enableKinetic : true
      }
    }));
    mapTile.setCenter(new OpenLayers.LonLat(135, -30).transform(epsg4326,
        epsg900913), 4);

    // Pauses to allow the drawing of the first map
    setTimeout(function() {
      mapTopo.addLayer(topoLayer);
      mapTopo.addControl(new OpenLayers.Control.Navigation({
        dragPanOptions : {
          enableKinetic : true
        }
      }));
      mapTopo.setCenter(new OpenLayers.LonLat(135, -30).transform(epsg4326,
          epsg900913), 4);
    }, 3000);
  }
</script>
</head>
<body onload="init()">
	<h1 id="title">Seamless tiled GeoJSON and TopoJSON</h1>
	<div id="tags">vector, geojson, topojson, feature, selecting,
		selection, popup</div>
	<p id="shortdesc">This shows how to use
		OpenLayers.Layer.SeeamlessGeoJSON to present tiled GeoJSON data (LGAs).</p>
	<div id="mapTile"
		style="width: 500px; height: 430px; border: 1px solid #ccc;"></div>
	<p id="shortdesc">This shows how to use
		OpenLayers.Layer.SeeamlessGeoJSON to present tiled TopoJSON data (PBCs).</p>
	<div id="mapTopo"
		style="width: 500px; height: 430px; border: 1px solid #ccc;"></div>
</body>
</html>
