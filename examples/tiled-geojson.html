<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Seamless tiled GeoJSON and TopoJSON</title>
<link rel="stylesheet" href="../theme/default/style.css" type="text/css">
<link rel="stylesheet" href="style.css" type="text/css">
<style type="text/css">
#controlToggle li {
	list-style: none;
}
</style>
<script src="../lib/OpenLayers.js"></script>
<script type="text/javascript">
  var mapTile, mapTopo, drawControls;
  var epsg4326 = new OpenLayers.Projection('EPSG:4326');
  var epsg900913 = new OpenLayers.Projection('EPSG:900913');
  
  function init() {
    mapTile = new OpenLayers.Map('mapTile', {
      displayProjection : epsg900913
    });
    mapTopo = new OpenLayers.Map('mapTopo', {
      displayProjection : epsg900913
    });

    // OpenStreetMap base layer with numZoomLevels set to number of data levels provided with this example
    var lay_osm = new OpenLayers.Layer.OSM("OpenStreetmap", [
        'http://a.tile.openstreetmap.org/${z}/${x}/${y}.png',
        'http://b.tile.openstreetmap.org/${z}/${x}/${y}.png',
        'http://c.tile.openstreetmap.org/${z}/${x}/${y}.png' ], {
      minZoomLevel : 4,
      maxZoomLevel : 17,
      projection : epsg900913
    });
    mapTile.addLayer(lay_osm);
    mapTopo.addLayer(lay_osm.clone());

    // GeoJson tiled layer (drawn in pink)
    var tileLayer = new OpenLayers.Layer.SeamlessGeoJSON("Json LGA",
        "http://localhost/vts/layers/lga/${z}/${x}/${y}.json", {
          projection : epsg900913,
          initialdelay: 500,
          tileloaddelay: 400,
          styleMap: new OpenLayers.StyleMap({default:  new OpenLayers.Style({
            strokeColor : "#FF66CC",
            fill : true,
            fillOpacity : 0.2,
            fillColor : "#FF66CC"
          }),
            select:  new OpenLayers.Style({
              strokeColor : "#66FFFF",
              fill : true,
              fillOpacity : 0.2,
              fillColor : "#66FFFF"
            })
          })
        }); 
     
    // TopoJson tiled layer (drawn in orange)
    var topoLayer = new OpenLayers.Layer.SeamlessGeoJSON("Topo LGA",
        "http://localhost/vts/layers/lga/${z}/${x}/${y}.topojson", {
          projection : epsg900913,
          format : "topojson",
          initialdelay: 500,
          tileloaddelay: 400,
          styleMap: new OpenLayers.StyleMap({default:  new OpenLayers.Style({
            strokeColor : "#FF9933",
            fill : true,
            fillOpacity : 0.2,
            fillColor : "#FF9933"
          }),
            select:  new OpenLayers.Style({
              strokeColor : "#66FFFF",
              fill : true,
              fillOpacity : 0.2,
              fillColor : "#66FFFF"
            })
          })
        });
    
    mapTile.addLayer(tileLayer);
    mapTile.addControl(new OpenLayers.Control.Navigation({
      dragPanOptions : {
        enableKinetic : true
      }
    }));
    mapTile.setCenter(new OpenLayers.LonLat(135, -30).transform(epsg4326,
        epsg900913), 4);

    // Pauses to allow the drawing of the first map
    setTimeout(function() {
      mapTopo.addLayer(topoLayer);
      mapTopo.addControl(new OpenLayers.Control.Navigation({
        dragPanOptions : {
          enableKinetic : true
        }
      }));
      mapTopo.setCenter(new OpenLayers.LonLat(135, -30).transform(epsg4326,
          epsg900913), 4);
    }, 3000);
    
    // Syncs the two maps
    var c1, c2, z1, z2; 
    mapTile.events.register("moveend", mapTile, function() { 
            c1 = this.getCenter(); 
            z1 = this.getZoom(); 
            mapTopo.panTo(c1); 
            mapTopo.zoomTo(z1); 
    }); 
    mapTopo.events.register("moveend", mapTopo, function() { 
            c2 = this.getCenter(); 
            z2 = this.getZoom(); 
            mapTile.panTo(c2); 
            mapTile.zoomTo(z2); 
    });     
  }
</script>
</head>
<body onload="init()">
	<h1 id="title">Seamless tiled GeoJSON and TopoJSON</h1>
	<div id="tags">vector, geojson, topojson, feature, selecting,
		selection, popup</div>
	<p id="shortdesc">This shows how to use
		OpenLayers.Layer.SeeamlessGeoJSON to present tiled GeoJSON data.</p>
	<div id="mapTile"
		style="width: 500px; height: 430px; border: 1px solid #ccc;"></div>
	<p id="shortdesc">This shows how to use
		OpenLayers.Layer.SeeamlessGeoJSON to present tiled TopoJSON data.</p>
	<div id="mapTopo"
		style="width: 500px; height: 430px; border: 1px solid #ccc;"></div>
</body>
</html>
